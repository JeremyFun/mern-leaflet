(this["webpackJsonpclient-app"]=this["webpackJsonpclient-app"]||[]).push([[0],{29:function(e,t,a){e.exports=a.p+"static/media/message-location.3d0c5526.svg"},30:function(e,t,a){e.exports=a.p+"static/media/my-location.40808547.svg"},34:function(e,t,a){e.exports=a(68)},39:function(e,t,a){},40:function(e,t,a){},68:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),s=a(11),i=a.n(s),r=(a(39),a(12)),c=a(20),l=a(27),m=a(28),u=a(33),g=a(32),h=(a(40),a(81)),p=a(82),d=a(71),f=a(80),v=a(8),E=a.n(v),y=a(17),M=a.n(y),b=a(72),S=a(73),w=a(74),j=a(75),k=a(76),x=a(77),z=a(78),O=a(79),C=a(29),U=a.n(C),L=a(30),A=a.n(L),I=new E.a.Icon({iconUrl:U.a,iconSize:[35,38],iconAnchor:[13.5,41],popupAnchor:[0,-41]}),N=new E.a.Icon({iconUrl:A.a,iconSize:[35,38],iconAnchor:[13.5,41],popupAnchor:[0,-41]}),T=M.a.object().keys({name:M.a.string().min(1).max(500).required(),message:M.a.string().min(1).max(500).required()}),J="localhost"===window.location.hostname?"http://localhost:5000/api/v1/messages":"production_url_here",_=function(e){Object(u.a)(a,e);var t=Object(g.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(e=t.call.apply(t,[this].concat(o))).state={location:{lat:50.4333,lng:30.4167},haveUserLocation:!1,zoom:2,userMessage:{name:"",message:""},sendingMessage:!1,sentMessage:!1,messages:[]},e.formIsValid=function(){var t={name:e.state.userMessage.name,message:e.state.userMessage.message},a=T.validate(t);if(e.state.haveUserLocation)return!a.error},e.formSubmitted=function(t){t.preventDefault(),e.setState({sendingMessage:!0}),e.formIsValid()&&fetch(J,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e.state.userMessage.name,message:e.state.userMessage.message,latitude:e.state.location.lat,longitude:e.state.location.lng})}).then((function(e){return e.json()})).then((function(t){console.log(t),setTimeout((function(){e.setState({sendingMessage:!1,sentMessage:!0})}),4e3)}))},e.valueChanged=function(t){var a=t.target,n=a.name,o=a.value;e.setState((function(e){return{userMessage:Object(c.a)(Object(c.a)({},e.userMessage),{},Object(r.a)({},n,o))}}))},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch(J).then((function(e){return e.json()})).then((function(t){var a={};t=t.reduce((function(e,t){var n="".concat(t.latitude.toFixed(2)).concat(t.longitude.toFixed(2));return a[n]?(console.log(a[n],"key"),a[n].otherMessages=a[n].otherMessages||[],a[n].otherMessages.push(t)):(a[n]=t,e.push(t)),e}),[]),e.setState({messages:t})})),navigator.geolocation.getCurrentPosition((function(t){e.setState({location:{lat:t.coords.latitude,lng:t.coords.longitude},haveUserLocation:!0,zoom:13})}),(function(){console.log("uh, oh... they didnt give us their location..."),fetch("http://ip-api.com/json/").then((function(e){return e.json()})).then((function(t){e.setState({location:{lat:t.lat,lng:t.lon},haveUserLocation:!0,zoom:13})}))}))}},{key:"render",value:function(){var e=[this.state.location.lat,this.state.location.lng];return o.a.createElement("div",{className:"map"},o.a.createElement(h.a,{className:"map",center:e,zoom:this.state.zoom},o.a.createElement(p.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),this.state.haveUserLocation?o.a.createElement(d.a,{position:e,icon:N},o.a.createElement(f.a,null,"A pretty CSS3 popup. ",o.a.createElement("br",null)," Easily customizable.")):"",this.state.messages.map((function(e){return o.a.createElement(d.a,{key:e._id,position:[e.latitude,e.longitude],icon:I},o.a.createElement(f.a,null,o.a.createElement("p",null,o.a.createElement("em",null,e.name),e.message),e.otherMessages?e.otherMessages.map((function(e){return o.a.createElement("p",{key:e._id},o.a.createElement("em",null,e.name)," : ",e.message)})):""))}))),o.a.createElement(b.a,{className:"message-form"},o.a.createElement(S.a,null,"Welcome to GuestM.app"),o.a.createElement(w.a,null,"Leave a message with your location!"),o.a.createElement(w.a,null,"Thanks for stopping by!"),this.state.sendingMessage||this.state.sentMessage||!this.state.haveUserLocation?this.state.sendingMessage||!this.state.haveUserLocation?o.a.createElement("video",{className:"video",autoPlay:!0,loop:!0,src:"https://media.giphy.com/media/xkC0zz2GObJfy/giphy.mp4"}):o.a.createElement(w.a,null,"Thanks for submitting a message!"):o.a.createElement(j.a,{onSubmit:this.formSubmitted},o.a.createElement(k.a,null,o.a.createElement(x.a,{for:"name"},"Name"),o.a.createElement(z.a,{onChange:this.valueChanged,type:"text",name:"name",id:"name",placeholder:"Enter your name"})),o.a.createElement(k.a,null,o.a.createElement(x.a,{for:"message"},"Message"),o.a.createElement(z.a,{onChange:this.valueChanged,type:"textarea",name:"message",id:"message",placeholder:"Enter a message"})),o.a.createElement(O.a,{type:"submit",color:"info",disabled:!this.formIsValid()},"Send"))))}}]),a}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(66),a(67);i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(_,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[34,1,2]]]);
//# sourceMappingURL=main.e000c2d8.chunk.js.map